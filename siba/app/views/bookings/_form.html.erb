<div class="width-control">
<%= form_for(@booking) do |f| %>
  <% if booking.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(booking.errors.count, "error") %> prohibited this booking from being saved:</h2>
      <ul>
      <% booking.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  <h3 class="subtotal">Price Per Person:</br>$<span id="current-price">0</span>.00</h3>
    <div class="form" id="booking-form">
    <fieldset>
      <legend class="legend-heading">Your Event</legend>
      <div class="row text-center">
      </div>
      <div class="row text-center">
        <div class="field">
          <%= f.label :guests, "Number of Guests" %><br>
          <%= f.number_field :guests %>
        </div>
        <div class="field">
          <%= f.label :address, "Where it's going down" %><br>
          <%= f.text_field :address %>
        </div>
        <div class="field">
          <%= f.label :date, "Date" %><br>
          <%= f.text_field :date, class: "datepicker" %>
        </div>
        <div class="field">
          <%= f.hidden_field :start_time, id: "start-time" %>
        </div>
        <div class="field">
          <%= f.hidden_field :hours, id: "number-of-hours" %>
        </div>
        <div id="time-range">
            <p>Base price includes 2 hours of open bar service with setup and bartenders.</p>
            <p>Time Range: <span class="slider-time">10:00 AM</span> - <span class="slider-time2">12:00 PM</span>

            </p>
            <div class="sliders_step1">
                <div id="slider-range"></div>
            </div>
        </div>
        <div class="field">
          <%= f.label :coupon_code, "Coupon Code?" %><br>
          <%= f.text_field :coupon_code, :id => 'existing-coupon', :placeholder=>'Coupon Code' %>
        </div>
      </div>
      </fieldset>
      <fieldset>
        <legend class="legend-heading">Your Bar</legend>
        <div class="row text-center">
          <h3>How many people are you expecting?</h3>
          <p>Base price includes 2 hours of open bar service with setup and bartenders.</p>
        </div>
        <div class="row text-center">
          <div class="field">
            <%= f.label :beer, "Beer" %><br>
            <%= f.select :beer, ['Craft Beer Session', 'Special Request (+$5/person)'] %>
          </div>
          <div class="field">
            <%= f.label :wine, "Wine" %><br>
            <%= f.select :wine, ['Wine Bar', 'Special Request (+$5/person)'] %>
          </div>
          <div class="field">
            <%= f.label :spirit, "Spirits" %><br>
            <%= f.select :spirit, ['Spirits Bar', 'Special Request (+$5/person)'] %>
          </div>
          <div class="field">
            <%= f.label :cocktail, "Cocktails" %><br>
            <%= f.select :cocktail, ['Sipbar Selection', 'Special Request (+$5/person)'] %>
          </div>
        </div>
      </fieldset>
      <fieldset>
        <legend class="legend-heading">Your Details</legend>
        <div class="row text-center">
          <h3>How many people are you expecting?</h3>
          <p>Base price includes 2 hours of open bar service with setup and bartenders.</p>
        </div>
        <div class="row text-center">
          <div class="field">
            <%= f.label :event_type, "Type of Party" %><br>
            <%= f.select :event_type, ['Wedding', 'Office Social', 'House Party'] %>
          </div>
          <div class="field">
            <%= f.label :company, "Your Company (optional)" %><br>
            <%= f.text_field :company %>
          </div>
          <div class="field">
            <%= f.label :glassware, "Glassware?" %><br>
            <%= f.check_box :glassware %>
          </div>
          <div class="field">
            <%= f.label :bar_rental, "Bar Rental?" %><br>
            <%= f.check_box :bar_rental %>
          </div>
          <div class="field">
            <%= f.label :virgin, "Virgin Drinks?" %><br>
            <%= f.check_box :virgin %>
          </div>
          <div class="field">
            <%= f.label :passed_drinks, "Passed drinks by staff?" %><br>
            <%= f.check_box :passed_drinks %>
          </div>
          <div class="field">
            <%= f.label :other, "Other requests?" %><br>
            <%= f.text_area :other %>
          </div>
          <div class="field">
            <%= f.label :delivery_details, "delivery details" %><br>
            <%= f.text_area :delivery_details, placeholder: "Instructions on how to load-in material, any additional important contact information for the venue etc." %>
          </div>
        </div>
        <div class="actions">
          <%= f.submit "Continue" %>
        </div>
      </fieldset>
  </div>
<% end %>
</div>
<script>
$(function() {
  $( ".datepicker" ).datepicker();

$("#slider-range").slider({
    range: true,
    min: 0,
    max: 1440,
    step: 60,
    values: [600, 720],
    slide: function (e, ui) {
        var hours1 = Math.floor(ui.values[0] / 60);
        var minutes1 = ui.values[0] - (hours1 * 60);

        if (hours1.length == 1) hours1 = '0' + hours1;
        if (minutes1.length == 1) minutes1 = '0' + minutes1;
        if (minutes1 == 0) minutes1 = '00';
        if (hours1 >= 12) {
            if (hours1 == 12) {
                hours1 = hours1;
                minutes1 = minutes1 + " PM";
            } else {
                hours1 = hours1 - 12;
                minutes1 = minutes1 + " PM";
            }
        } else {
            hours1 = hours1;
            minutes1 = minutes1 + " AM";
        }
        if (hours1 == 0) {
            hours1 = 12;
            minutes1 = minutes1;
        }



        $('.slider-time').html(hours1 + ':' + minutes1);

        var hours2 = Math.floor(ui.values[1] / 60);
        var minutes2 = ui.values[1] - (hours2 * 60);

        var hourStart = Math.floor(ui.values[0] / 60);
        var hourEnd = Math.floor(ui.values[1] / 60);

        console.log("start: " + hourStart,"end: " + hourEnd)
        console.log(hourEnd - hourStart)

        var input1 = $( "#number-of-hours" );
        input1.val( hourEnd - hourStart );

        var input2 = $( "#start-time" );
        input2.val( hourStart );

        if (hours2.length == 1) hours2 = '0' + hours2;
        if (minutes2.length == 1) minutes2 = '0' + minutes2;
        if (minutes2 == 0) minutes2 = '00';
        if (hours2 >= 12) {
            if (hours2 == 12) {
                hours2 = hours2;
                minutes2 = minutes2 + " PM";
            } else if (hours2 == 24) {
                hours2 = 11;
                minutes2 = "59 PM";
            } else {
                hours2 = hours2 - 12;
                minutes2 = minutes2 + " PM";
            }
        } else {
            hours2 = hours2;
            minutes2 = minutes2 + " AM";
        }

        $('.slider-time2').html(hours2 + ':' + minutes2);
    }
});


});
</script>
<style>

</style>
